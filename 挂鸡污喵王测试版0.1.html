<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>挂鸡污喵王内测版0.1</title>
    <style>
        /* --- Base Styles --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(to bottom, #0a1a25, #1a3b5c);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 8px; /* <-- 修改: 减少 body 内边距 */
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .container {
            width: 1000px;
            border: 2px solid #5d8aa8;
            border-radius: 8px;
            background: rgba(13, 30, 45, 0.9);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
            overflow: hidden;
        }

        .status-bar {
            display: flex;
            align-items: center; /* Vertically align items */
            padding: 10px 15px; /* <-- 修改: 减少状态栏内边距 */
            background: linear-gradient(to right, #1c2f40, #2a4865);
            border-bottom: 2px solid #5d8aa8;
            flex-wrap: wrap;
        }

        .status-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px; /* <-- 修改: 减少状态项间隙 */
        }

        .status-item { display: flex; align-items: center; margin: 3px; font-size: 14px; } /* <-- 修改: 减少状态项外边距 */
        .status-icon { margin-right: 5px; font-size: 16px; }

        /* New Layout: Content Wrapper */
        .content-wrapper { display: flex; padding: 12px; gap: 10px; } /* <-- 修改: 减少内边距和列间隙 */
        .main-column { flex: 1; display: flex; flex-direction: column; gap: 10px; } /* <-- 修改: 减少行间隙 */
        .sidebar-column { width: 300px; display: flex; flex-direction: column; gap: 10px; } /* <-- 修改: 减少行间隙 */

        /* 战斗动画区域 */
        .animation-area { 
            flex: 1; 
            background: #0a1a25; 
            border: 2px solid #5d8aa8; 
            border-radius: 6px; 
            position: relative; 
            overflow: hidden; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            /* 原 min-height: 446px; 缩减 20% -> 446 * 0.8 = 356.8 */
            min-height: 357px; /* <-- 计算/修改: 缩短最小高度约 20% */
        }
        
        .animation-area canvas {
            max-width: 100%;
            height: auto; 
            background-color: #16213e; 
            border-radius: 6px; 
            border: 2px solid #fca311; 
            object-fit: contain;
        }
        
        .instructions { 
            position: absolute; 
            bottom: 8px; /* <-- 修改: 稍微上移一点 */
            left: 50%; 
            transform: translateX(-50%); 
            font-size: 13px; /* <-- 修改: 略微缩小字体 */
            color: #bbb; 
            text-align: center; 
            z-index: 10; 
            background: rgba(0,0,0,0.4); 
            padding: 4px 8px; /* <-- 修改: 减少内边距 */
            border-radius: 5px; 
        }

        /* 副本进度区域样式 */
        .dungeon-progress-area {
            width: 300px; 
            height: 250px; /* <-- 修改: 缩短高度 */
            background: #0c151f;
            border: 2px solid #5d8aa8; border-radius: 6px;
            display: flex; flex-direction: column;
        }
        .progress-title { text-align: center; padding: 8px; background: rgba(28, 47, 64, 0.7); border-bottom: 1px solid #5d8aa8; font-weight: bold; } /* <-- 修改: 减少内边距 */
        .boss-list { flex: 1; padding: 8px; overflow-y: auto; list-style: none; } /* <-- 修改: 减少内边距 */
        .boss-item { padding: 4px; border-bottom: 1px solid #2c4459; font-size: 13px; } /* <-- 修改: 减少内边距和字体大小 */
        .boss-item.current { color: #ffcc00; font-weight: bold; }
        .boss-item.completed { color: #88dd88; text-decoration: line-through; }
        .boss-item:last-child { border-bottom: none; }
        .progress-button-container { padding: 8px; text-align: center; } /* <-- 修改: 减少内边距 */

        /* 消息区域样式 */
        .message-header { display: flex; align-items: center; margin-bottom: 8px; font-weight: bold; color: #ffcc00; } /* <-- 修改: 减少下边距 */
        .message-container { 
            background: #0c151f; 
            border: 2px solid #5d8aa8; 
            border-radius: 6px; 
            height: 200px; /* <-- 修改: 缩短高度 */
            overflow-y: auto; 
            padding: 8px; /* <-- 修改: 减少内边距 */
        }
        .message { margin-bottom: 2px; padding: 2px 5px; border-bottom: none; font-size: 13px; }
        .system { color: #FF9900; }
        .combat { color: #66B3FF; }
        .reward { color: #00FF7F; }
        .error { color: #CC0000; }
        .legendary { color: #ff8000; font-weight: bold;}


        /* 底部按钮区域 */
        .button-section { padding: 12px; background: linear-gradient(to right, #1c2f40, #2a4865); border-top: 2px solid #5d8aa8; } /* <-- 修改: 减少内边距 */
        .button-header { text-align: center; margin-bottom: 8px; font-weight: bold; } /* <-- 修改: 减少下边距 */
        .button-row { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 8px; } /* <-- 修改: 减少间隙和下边距 */
        .wow-button { padding: 8px 16px; background: linear-gradient(to bottom, #3a6187, #1c2f40); border: 1px solid #5d8aa8; border-radius: 4px; color: #e0e0e0; cursor: pointer; font-weight: bold; transition: all 0.2s; min-width: 110px; text-align: center; font-size: 14px; } /* <-- 修改: 减少内边距和最小宽度 */
        .wow-button:hover { background: linear-gradient(to bottom, #4a79ab, #2a4865); box-shadow: 0 0 8px rgba(93, 138, 168, 0.6); }
        .wow-button:active { transform: translateY(1px); } /* <-- 修改: 减少按下距离 */
        .wow-button.disabled { background: #2a3b4a; color: #777; cursor: not-allowed; border-color: #444; }
        .wow-button.disabled:hover { transform: none; box-shadow: none; background: #2a3b4a; }

        .save-button-group { margin-left: auto; display: flex; gap: 8px;} /* <-- 修改: 减少间隙 */
        #importSaveBtn, #exportSaveBtn, #clearSaveBtn {
             padding: 6px 12px; /* <-- 修改: 减少内边距 */
             min-width: auto;
             font-size: 13px; /* <-- 修改: 缩小字体 */
        }
        #importSaveBtn { background: linear-gradient(to bottom, #2ca058, #1d6b3b); border-color: #3ac876; }
        #importSaveBtn:hover { background: linear-gradient(to bottom, #32b865, #228045); box-shadow: 0 0 8px rgba(58, 200, 118, 0.6); }
        #exportSaveBtn { background: linear-gradient(to bottom, #2c8ca0, #1d5b6b); border-color: #3ac8b0; }
        #exportSaveBtn:hover { background: linear-gradient(to bottom, #32a2b8, #226b80); box-shadow: 0 0 8px rgba(58, 200, 176, 0.6); }
        #clearSaveBtn { background: linear-gradient(to bottom, #a02c2c, #6b1d1d); border-color: #c83a3a; }
        #clearSaveBtn:hover { background: linear-gradient(to bottom, #b83232, #802222); box-shadow: 0 0 8px rgba(200, 58, 58, 0.6); }

        /* 任务区域样式 */
        .quest-area { flex: 1; background: #0c151f; border: 2px solid #5d8aa8; border-radius: 6px; display: flex; flex-direction: column; }
        .quest-title { text-align: center; padding: 8px; background: rgba(28, 47, 64, 0.7); border-bottom: 1px solid #5d8aa8; font-weight: bold; } /* <-- 修改: 减少内边距 */
        .quest-list { flex: 1; padding: 8px; overflow-y: auto; } /* <-- 修改: 减少内边距 */
        .quest-item { padding: 6px; border-bottom: 1px solid #2c4459; font-size: 13px; } /* <-- 修改: 减少内边距和字体大小 */
        .quest-item:last-child { border-bottom: none; }
        .quest-progress { display: flex; justify-content: space-between; align-items: center; margin-top: 4px; } /* <-- 修改: 减少上边距 */
        .quest-claim-btn { padding: 3px 6px; background: #3a6187; border: 1px solid #5d8aa8; color: #e0e0e0; border-radius: 3px; cursor: pointer; font-size: 12px; } /* <-- 修改: 减少内边距和字体大小 */
        .quest-claim-btn:disabled { background: #2a3b4a; color: #777; cursor: not-allowed; }

        /* 滚动条样式 */
        ::-webkit-scrollbar { width: 8px; } /* <-- 修改: 变窄 */
        ::-webkit-scrollbar-track { background: #0c151f; }
        ::-webkit-scrollbar-thumb { background: #3a6187; border-radius: 4px; } /* <-- 修改: 调整圆角 */
        ::-webkit-scrollbar-thumb:hover { background: #4a79ab; }

        /* 战斗模拟样式 (结果屏幕) */
        #resultScreen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 100; border-radius: 6px; }
        .result-text { font-size: 32px; color: gold; margin-bottom: 15px; text-align: center; } /* <-- 修改: 缩小字体和间距 */
        .stats-text { font-size: 20px; margin: 8px 0; text-align: center; } /* <-- 修改: 缩小字体和间距 */
        .countdown-text { font-size: 18px; margin-top: 30px; color: #fca311; text-align: center; } /* <-- 修改: 缩小字体和间距 */
        .scene-indicator { position: absolute; top: 8px; left: 8px; background-color: rgba(0, 0, 0, 0.5); padding: 6px 10px; border-radius: 4px; font-weight: bold; z-index: 10; font-size: 13px; } /* <-- 修改: 调整位置/内边距/字体 */

        /* 弹窗通用样式 */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none; justify-content: center; align-items: center; z-index: 200;
        }
        .modal-content {
            width: 600px; max-height: 80vh;
            background: linear-gradient(to bottom, #0a1a25, #1a3b5c);
            border: 2px solid #5d8aa8; border-radius: 8px;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.8);
            display: flex; flex-direction: column;
        }
        .modal-header {
            padding: 12px; border-bottom: 1px solid #5d8aa8; /* <-- 修改: 减少内边距 */
            display: flex; justify-content: space-between; align-items: center;
        }
        .modal-header h2 { color: #ffcc00; font-size: 18px; } /* <-- 修改: 缩小字体 */
        .modal-close {
            font-size: 20px; color: #e0e0e0; cursor: pointer; /* <-- 修改: 缩小字体 */
            border: none; background: none; font-weight: bold;
        }
        .modal-body { padding: 15px; overflow-y: auto; } /* <-- 修改: 减少内边距 */

        /* 地下城进度弹窗 */
        .dungeon-list-container { display: flex; gap: 15px; } /* <-- 修改: 减少间隙 */
        .dungeon-list { flex: 1; }
        .dungeon-list h3 { color: #aaddff; margin-bottom: 8px; border-bottom: 1px solid #4a79ab; padding-bottom: 4px; font-size: 15px;} /* <-- 修改: 调整间距/字体 */
        .dungeon-list ul { list-style: none; padding: 0; margin: 0; }
        .dungeon-list li { padding: 3px; border-radius: 4px; margin-bottom: 2px; background: #0c151f; transition: background-color 0.2s; font-size: 13px; } /* <-- 修改: 减少内边距/字体 */
        .dungeon-list li:hover { background-color: #1a3b5c; cursor: pointer; }
        .dungeon-list li.completed { color: #88dd88; }
        .dungeon-list li.current { background-color: #fca311; color: #000; font-weight: bold; }

        /* 兑换中心弹窗 */
        .exchange-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px; /* <-- 修改: 减少内边距 */
            margin-bottom: 6px; /* <-- 修改: 减少间距 */
            background: #0c151f;
            border: 1px solid #2c4459;
            border-radius: 4px;
        }
        .exchange-info {
            font-size: 13px; /* <-- 修改: 缩小字体 */
            line-height: 1.4;
        }
        .exchange-info .badge-name {
            font-weight: bold;
            color: #aaddff;
        }
        
        .exchange-currency-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; 
            gap: 6px 12px; /* <-- 修改: 减少间隙 */
            padding: 8px; /* <-- 修改: 减少内边距 */
            background: #0c151f;
            border: 1px solid #2c4459;
            border-radius: 4px;
            margin-bottom: 12px; /* <-- 修改: 减少间距 */
        }
        .currency-item {
            display: flex;
            justify-content: space-between; 
            font-size: 13px; /* <-- 修改: 缩小字体 */
            color: #e0e0e0;
        }
        .currency-item span:first-child {
            color: #aaddff; 
        }
        .currency-item span:last-child {
            font-weight: bold; 
        }
        .exchange-divider {
            border: none;
            border-top: 1px solid #5d8aa8;
            margin: 12px 0; /* <-- 修改: 减少间距 */
        }
        .modal-body h3 {
             font-size: 16px; /* <-- 修改: 缩小标题字体 */
             margin-bottom: 8px; /* <-- 修改: 减少下边距 */
             color: #aaddff;
        }


        /* 页脚信息样式 */
        .footer-info {
            text-align: right;
            padding: 6px 12px; /* <-- 修改: 减少内边距 */
            font-size: 11px; /* <-- 修改: 缩小字体 */
            color: #7a9bb7;
            background-color: #112233;
            border-top: 1px solid #2c4459;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="status-bar">
            <div class="status-group">
                <div class="status-item"><span class="status-icon">🔪</span><span>熟练度: <span id="proficiencyDisplay">...</span></span></div>
                <div class="status-item"><span class="status-icon">⭐</span><span>装备等级: <span id="gearScoreDisplay">...</span></span></div>
                <div class="status-item"><span class="status-icon">💰</span><span>金币: <span id="goldDisplay">...</span></span></div>
                <div class="status-item" id="atiyehStaffIcon" style="display: none;"><span class="status-icon">🍗</span><span class="legendary">埃提耶什·守护者的传说之杖</span></div>
            </div>
             <div class="save-button-group">
                <button id="importSaveBtn" class="wow-button">导入存档</button>
                <button id="exportSaveBtn" class="wow-button">导出存档</button>
                <button id="clearSaveBtn" class="wow-button">清除存档</button>
            </div>
        </div>

        <div class="content-wrapper">
            <div class="main-column">
                <div class="animation-area" id="animationArea">
                    <div class="scene-indicator" id="sceneIndicator">选择地下城开始</div>
                    <canvas id="gameCanvas" width="900" height="600"></canvas>
                    <div class="instructions">勇士将自动攻击敌人，击败所有敌人进入下一场景</div>
                    <div id="resultScreen">
                        <div class="result-text" id="battleResult"></div>
                        <div class="stats-text" id="survivorsCount"></div>
                        <div class="stats-text" id="battleTime"></div>
                        <div class="countdown-text" id="countdown"></div>
                    </div>
                </div>
                <div class="message-section">
                    <div class="message-header"><span>📜 消息日志</span></div>
                    <div class="message-container" id="messageContainer"><div class="message system">📢 欢迎来到挂鸡污喵王内测版0.1！</div><div class="message system">📢 游戏已初始化，请选择一个地下城开始冒险！</div></div>
                </div>
            </div>
            <div class="sidebar-column">
                 <div class="dungeon-progress-area">
                    <div class="progress-title" id="dungeonProgressTitle">副本进度区域</div>
                    <ul class="boss-list" id="bossList"></ul>
                    <div class="progress-button-container">
                        <button class="wow-button" id="viewProgressBtn">查看地下城进度</button>
                    </div>
                </div>
                <div class="quest-area">
                    <div class="quest-title">📜 任务列表</div><div class="quest-list" id="questList"></div>
                </div>
            </div>
        </div>

        <div class="button-section">
            <div class="button-header">🏰 功能与地下城选择</div>
            <div class="button-row">
                <div class="wow-button" id="dungeon5Btn">5人地下城</div>
                <div class="wow-button" id="dungeon10Btn">10人团队副本</div>
                <div class="wow-button" id="dungeon25Btn">25人团队副本</div>
                <div class="wow-button" id="exchangeBtn">兑换中心</div>
            </div>
        </div>
        
        <div class="footer-info">
            测试版当前游戏目标为：获取埃提耶什·守护者的传说之杖。参与改进本游戏请加挂鸡污喵王QQ群63825952
        </div>
    </div>

    <div id="progressModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>地下城进度 (点击可直接挑战)</h2>
                <button class="modal-close" id="progressModalCloseBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="dungeon-list-container">
                    <div class="dungeon-list">
                        <h3>5人地下城</h3>
                        <ul id="dungeon5pList"></ul>
                    </div>
                    <div class="dungeon-list">
                        <h3>10人团队副本</h3>
                        <ul id="dungeon10pList"></ul>
                    </div>
                    <div class="dungeon-list">
                        <h3>25人团队副本</h3>
                        <ul id="dungeon25pList"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="exchangeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>兑换中心</h2>
                <button class="modal-close" id="exchangeModalCloseBtn">&times;</button>
            </div>
            <div class="modal-body" id="exchangeModalBody">
            </div>
        </div>
    </div>

    <script src="data.js"></script> 
    <script src="battle.js"></script> 
    <script src="battle-animation.js"></script> 
    
    <script src="game-bundle.js"></script>

</body>
</html>